id: TAXII2 Server Performance Test
version: -1
name: TAXII2 Server Performance Test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c174e0f7-a04f-473c-82a8-0b104e7b6745
    type: start
    task:
      id: c174e0f7-a04f-473c-82a8-0b104e7b6745
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "1":
    id: "1"
    taskid: ec691cb8-3095-4784-8a78-1a85220f3248
    type: regular
    task:
      id: ec691cb8-3095-4784-8a78-1a85220f3248
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "2":
    id: "2"
    taskid: 70a17264-8b17-4773-88f7-eb524f2bf63f
    type: title
    task:
      id: 70a17264-8b17-4773-88f7-eb524f2bf63f
      version: -1
      name: 10,000 Indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "61"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3170
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "3":
    id: "3"
    taskid: 4a3cd81b-9e89-4d8c-8c4c-d6eecaa5488d
    type: playbook
    task:
      id: 4a3cd81b-9e89-4d8c-8c4c-d6eecaa5488d
      version: -1
      name: TAXII2 Performance Test - Concurrency
      playbookName: TAXII2 Performance Test - Concurrency
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      "n":
        simple: ${inputs.n}
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=10000
      z:
        simple: ${inputs.z}
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5065
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "4":
    id: "4"
    taskid: 76e69b6a-8733-43b3-8638-a2de35ad3c53
    type: playbook
    task:
      id: 76e69b6a-8733-43b3-8638-a2de35ad3c53
      version: -1
      name: TAXII2 Performance Test - Concurrency
      playbookName: TAXII2 Performance Test - Concurrency
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=50000
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "5":
    id: "5"
    taskid: 8574ff95-2471-4af1-8680-7b5adfe6470c
    type: title
    task:
      id: 8574ff95-2471-4af1-8680-7b5adfe6470c
      version: -1
      name: 50,000 Indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "38"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "6":
    id: "6"
    taskid: 4769f2ef-d5c1-440f-8c94-5cb4421d3d91
    type: title
    task:
      id: 4769f2ef-d5c1-440f-8c94-5cb4421d3d91
      version: -1
      name: 90,000 Indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "48"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7835
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "7":
    id: "7"
    taskid: 2c1ceb9a-db26-4b81-8a45-5ef901010ac5
    type: playbook
    task:
      id: 2c1ceb9a-db26-4b81-8a45-5ef901010ac5
      version: -1
      name: TAXII2 Performance Test - Concurrency
      playbookName: TAXII2 Performance Test - Concurrency
      type: playbook
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=90000
    separatecontext: false
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9555
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "8":
    id: "8"
    taskid: 3dd57892-d98b-43b5-8aeb-077bfbc9aeba
    type: regular
    task:
      id: 3dd57892-d98b-43b5-8aeb-077bfbc9aeba
      version: -1
      name: Set Small Outputs
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      key:
        simple: EDLHey.Small
      value:
        complex:
          root: HeyConcurrency
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5240
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "9":
    id: "9"
    taskid: 61d29501-c906-41c5-8d9d-5abdbc95670f
    type: regular
    task:
      id: 61d29501-c906-41c5-8d9d-5abdbc95670f
      version: -1
      name: Clear HeyConcurrency Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: HeyConcurrency
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5415
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "10":
    id: "10"
    taskid: bad788f5-7208-44a9-8461-38dfc2942762
    type: regular
    task:
      id: bad788f5-7208-44a9-8461-38dfc2942762
      version: -1
      name: Set Medium Outputs
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      key:
        simple: EDLHey.Medium
      value:
        simple: ${HeyConcurrency}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7485
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "11":
    id: "11"
    taskid: 84dbb9c2-8122-4164-8bb3-b02438225d12
    type: regular
    task:
      id: 84dbb9c2-8122-4164-8bb3-b02438225d12
      version: -1
      name: Clear HeyConcurrency Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: HeyConcurrency
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "12":
    id: "12"
    taskid: f7b3b4b6-10c1-4079-8ffb-148be2557410
    type: regular
    task:
      id: f7b3b4b6-10c1-4079-8ffb-148be2557410
      version: -1
      name: Set Large Outputs
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "60"
    scriptarguments:
      key:
        simple: EDLHey.Large
      value:
        simple: ${HeyConcurrency}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "14":
    id: "14"
    taskid: 58ba413b-6227-44a5-8ccd-0b5fa827834f
    type: regular
    task:
      id: 58ba413b-6227-44a5-8ccd-0b5fa827834f
      version: -1
      name: Check IP Is Ready
      description: Returns, whether there're, are enough indicators in the system.
      scriptName: VerifyEnoughIndicators
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      query:
        simple: type:IP
      size:
        simple: ${inputs.iocs_in_xsoar}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "15":
    id: "15"
    taskid: f3b64882-cc5b-471c-822a-ee8c622f57c0
    type: condition
    task:
      id: f3b64882-cc5b-471c-822a-ee8c622f57c0
      version: -1
      name: Verify IP Is Ready
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "17"
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: IndicatorsCheck.ConditionMet
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "16":
    id: "16"
    taskid: 96c3b56e-96ba-40b2-87ce-9bbbedd47a40
    type: regular
    task:
      id: 96c3b56e-96ba-40b2-87ce-9bbbedd47a40
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "17":
    id: "17"
    taskid: cc78bd3d-211c-4b13-8aec-98a5ecf8ed9c
    type: playbook
    task:
      id: cc78bd3d-211c-4b13-8aec-98a5ecf8ed9c
      version: -1
      name: GenericPolling
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      playbookName: GenericPolling
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      AdditionalPollingCommandArgNames:
        simple: size
      AdditionalPollingCommandArgValues:
        simple: ${inputs.iocs_in_xsoar}
      Ids:
        simple: type:IP
      Interval:
        simple: "1"
      PollingCommandArgName:
        simple: query
      PollingCommandName:
        simple: VerifyEnoughIndicators
      Timeout:
        simple: "10"
      dt:
        simple: IndicatorsCheck(val.ConditionMet !== true).Query
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "18":
    id: "18"
    taskid: d05d239b-c24a-4a41-83d6-b4337f1889e7
    type: regular
    task:
      id: d05d239b-c24a-4a41-83d6-b4337f1889e7
      version: -1
      name: Check Domain Is Ready
      description: Returns, whether there're, are enough indicators in the system.
      scriptName: VerifyEnoughIndicators
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      query:
        simple: type:Domain
      size:
        simple: ${inputs.iocs_in_xsoar}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "19":
    id: "19"
    taskid: b4f3b802-6470-4a5f-8a3d-0f0c8f156f04
    type: condition
    task:
      id: b4f3b802-6470-4a5f-8a3d-0f0c8f156f04
      version: -1
      name: Verify Domain Is Ready
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "21"
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: IndicatorsCheck.ConditionMet
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "20":
    id: "20"
    taskid: 8becf270-9a9b-4fc5-81f4-a7dee2e82285
    type: regular
    task:
      id: 8becf270-9a9b-4fc5-81f4-a7dee2e82285
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "21":
    id: "21"
    taskid: fd8c2a87-d8ea-4611-854d-186dfeb174e7
    type: playbook
    task:
      id: fd8c2a87-d8ea-4611-854d-186dfeb174e7
      version: -1
      name: GenericPolling
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      playbookName: GenericPolling
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      AdditionalPollingCommandArgNames:
        simple: size
      AdditionalPollingCommandArgValues:
        simple: ${inputs.iocs_in_xsoar}
      Ids:
        simple: type:Domain
      Interval:
        simple: "1"
      PollingCommandArgName:
        simple: query
      PollingCommandName:
        simple: VerifyEnoughIndicators
      Timeout:
        simple: "10"
      dt:
        simple: IndicatorsCheck(val.ConditionMet !== true).Query
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "22":
    id: "22"
    taskid: 3da5c251-2e36-41fa-868a-a64b0c1c96a9
    type: regular
    task:
      id: 3da5c251-2e36-41fa-868a-a64b0c1c96a9
      version: -1
      name: Check URL Is Ready
      description: Returns, whether there're, are enough indicators in the system.
      scriptName: VerifyEnoughIndicators
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      query:
        simple: type:URL
      size:
        simple: ${inputs.iocs_in_xsoar}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "23":
    id: "23"
    taskid: ae06704b-493f-49c2-8336-64e9def2d7cb
    type: regular
    task:
      id: ae06704b-493f-49c2-8336-64e9def2d7cb
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "24":
    id: "24"
    taskid: 6e3ad612-0ac5-4e90-889b-4a8121567c85
    type: condition
    task:
      id: 6e3ad612-0ac5-4e90-889b-4a8121567c85
      version: -1
      name: Verify URL Is Ready
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "25"
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isTrue
          left:
            value:
              simple: IndicatorsCheck.ConditionMet
            iscontext: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "25":
    id: "25"
    taskid: 6264e90d-9e45-4151-8bca-433c2d8e11df
    type: playbook
    task:
      id: 6264e90d-9e45-4151-8bca-433c2d8e11df
      version: -1
      name: GenericPolling
      description: |-
        Use this playbook as a sub-playbook to block execution of the master playbook until a remote action is complete.
        This playbook implements polling by continuously running the command in Step \#2 until the operation completes.
        The remote action should have the following structure:

        1. Initiate the operation.
        2. Poll to check if the operation completed.
        3. (optional) Get the results of the operation.
      playbookName: GenericPolling
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      AdditionalPollingCommandArgNames:
        simple: size
      AdditionalPollingCommandArgValues:
        simple: ${inputs.iocs_in_xsoar}
      Ids:
        simple: type:URL
      Interval:
        simple: "1"
      PollingCommandArgName:
        simple: query
      PollingCommandName:
        simple: VerifyEnoughIndicators
      Timeout:
        simple: "10"
      dt:
        simple: IndicatorsCheck(val.ConditionMet !== true).Query
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 377.5,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "27":
    id: "27"
    taskid: e9590d38-5892-4db1-8537-02c02693a2df
    type: regular
    task:
      id: e9590d38-5892-4db1-8537-02c02693a2df
      version: -1
      name: Set URL For XSOAR 6
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: ServerURL
      value:
        complex:
          root: ServerURL
          accessor: URL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /instance/execute/taxii2server/
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "28":
    id: "28"
    taskid: 53546b09-b369-4b42-87b3-5d334bb7a8a3
    type: regular
    task:
      id: 53546b09-b369-4b42-87b3-5d334bb7a8a3
      version: -1
      name: Get Server URL
      description: Get the Server URL.
      scriptName: GetServerURL
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "62"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "29":
    id: "29"
    taskid: 104829be-9fce-47af-8074-664e5e42ecb0
    type: regular
    task:
      id: 104829be-9fce-47af-8074-664e5e42ecb0
      version: -1
      name: Send URL Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=10000&match[type]=url
      password:
        simple: '{TOMMED}7DTVwutgvncbdicYdK+lcNcle4o2axLVpe1Mi2sYrPUTUmnpHkG5dA6AWVsYqi1MNN0p8t9NN0S0MGY1N4JZfw=='
      username:
        simple: ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "30":
    id: "30"
    taskid: 5cf5c3ba-0ad0-4328-8ea3-5715894cbdab
    type: condition
    task:
      id: 5cf5c3ba-0ad0-4328-8ea3-5715894cbdab
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "33"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "18"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3665
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "31":
    id: "31"
    taskid: f8b482d3-3c45-411a-85d7-1caff5555743
    type: regular
    task:
      id: f8b482d3-3c45-411a-85d7-1caff5555743
      version: -1
      name: Send IP Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=10000&match[type]=ip
      password:
        simple: '{TOMMED}YwM9remcfGtE9Y2ML4wibuEegHEe2nfY+9H45JuIenEil468ga9ETa4Wktt/DU7HLaC6UU6YdiO333UxzhKY+w=='
      username:
        simple: ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4015
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "32":
    id: "32"
    taskid: e66eb6db-9cdb-4bff-811e-e923e4271e45
    type: condition
    task:
      id: e66eb6db-9cdb-4bff-811e-e923e4271e45
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "18"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4190
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: e5549a41-0298-495d-8679-a4845aa287bf
    type: regular
    task:
      id: e5549a41-0298-495d-8679-a4845aa287bf
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "34":
    id: "34"
    taskid: 7a4fe24b-e6cb-4d5c-8ddb-3215aa8449d3
    type: regular
    task:
      id: 7a4fe24b-e6cb-4d5c-8ddb-3215aa8449d3
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "35":
    id: "35"
    taskid: 14f83d9b-8656-4ac1-8112-fd20ab94da47
    type: regular
    task:
      id: 14f83d9b-8656-4ac1-8112-fd20ab94da47
      version: -1
      name: Send Domain Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "36"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=10000&match[type]=domain-name
      password:
        simple: '{TOMMED}JCR0pYmZ+ugzFhDC4RZoITBilAR23eYT3zvNyM4yJGClh1L9nI3riYf9WnEz3HweZnqfqWQIZaefTo6SCdWfrg=='
      username:
        simple: ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "36":
    id: "36"
    taskid: 66a666cc-f63e-44f2-86bc-c35ce4f31f46
    type: condition
    task:
      id: 66a666cc-f63e-44f2-86bc-c35ce4f31f46
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "57"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "18"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4715
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "38":
    id: "38"
    taskid: cc58cce3-ff4c-4fbc-88ff-2a88ff91dc75
    type: regular
    task:
      id: cc58cce3-ff4c-4fbc-88ff-2a88ff91dc75
      version: -1
      name: Send URL Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=50000&match[type]=url
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5735
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "39":
    id: "39"
    taskid: 3a0b9bad-7cdc-45ef-8549-faf1f2a5d83c
    type: condition
    task:
      id: 3a0b9bad-7cdc-45ef-8549-faf1f2a5d83c
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "30"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 5910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "40":
    id: "40"
    taskid: 84fd65d7-aa2d-46c6-8dad-6449e30c51fb
    type: regular
    task:
      id: 84fd65d7-aa2d-46c6-8dad-6449e30c51fb
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "41"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6085
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "41":
    id: "41"
    taskid: f4206e7a-66e5-4671-84f0-2989b8408634
    type: regular
    task:
      id: f4206e7a-66e5-4671-84f0-2989b8408634
      version: -1
      name: Send IP Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=50000&match[type]=ip
      password:
        simple: '{TOMMED}uSjAdmbmM1unDamEQa1/EJI/1i6iVKwLNGPvsJLAey7otipiGhTSCqL4vLQ8r8NqlLLSzjPiQ7PfOdtiJFglWg=='
      username:
        simple: ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6260
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "42":
    id: "42"
    taskid: 91aff103-83cc-407a-8c3e-602d2fdb2421
    type: condition
    task:
      id: 91aff103-83cc-407a-8c3e-602d2fdb2421
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "43"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "30"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6435
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "43":
    id: "43"
    taskid: 5d4e21a9-548b-4dbd-844a-7000363c6977
    type: regular
    task:
      id: 5d4e21a9-548b-4dbd-844a-7000363c6977
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "44"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6610
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "44":
    id: "44"
    taskid: a92a42bc-73a0-407c-80b8-f81d5e2b8e0d
    type: regular
    task:
      id: a92a42bc-73a0-407c-80b8-f81d5e2b8e0d
      version: -1
      name: Send Domain Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=50000&match[type]=domain-name
      password:
        simple: '{TOMMED}Z4chu/0OpDgxA9fTz+QdRQIsB8PVuqEOJmBaBKArMa5qQKrA3ri1I3Pp2SefhlZnXok33mjaU6C7edS4f/7oFg=='
      username:
        simple: ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6785
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "45":
    id: "45"
    taskid: a0ced84b-7178-435b-8b51-c207aa548e50
    type: condition
    task:
      id: a0ced84b-7178-435b-8b51-c207aa548e50
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "58"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "30"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 6960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "48":
    id: "48"
    taskid: 91b9f75c-52cd-41d9-8f27-eaa9bec446c3
    type: regular
    task:
      id: 91b9f75c-52cd-41d9-8f27-eaa9bec446c3
      version: -1
      name: Send URL Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=90000&match[type]=url
      password:
        simple: '{TOMMED}e1QFW9pvG8dkIYzXlzgA4kahSMEvIdUnfkVkGBQCIq1uD4VDh3NjCspmKd6vgfcMlp4eOBm0A+SBbtHnZr7Xqw=='
      username:
        simple: ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "49":
    id: "49"
    taskid: 74d44457-cd3b-4476-8ead-26cbc8eaa4a1
    type: condition
    task:
      id: 74d44457-cd3b-4476-8ead-26cbc8eaa4a1
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "50"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "90"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8155
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "50":
    id: "50"
    taskid: dd85446a-845f-483e-8882-119990d770d4
    type: regular
    task:
      id: dd85446a-845f-483e-8882-119990d770d4
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "51"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "51":
    id: "51"
    taskid: de2e3836-8db7-4b92-8ba4-e5f74008cdd6
    type: regular
    task:
      id: de2e3836-8db7-4b92-8ba4-e5f74008cdd6
      version: -1
      name: Send IP Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=90000&match[type]=ip
      password:
        simple: '{TOMMED}Kg7sk21JDBQZCO9obK8cU9HH5LvISQxYm9i+M2JckD761Y/okAQg3ph2cucSFhOCUifnpvVQceZRnmB1adrmDA=='
      username:
        simple: ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8505
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "52":
    id: "52"
    taskid: 31b18644-ad70-4a74-88ce-22674f7624b1
    type: condition
    task:
      id: 31b18644-ad70-4a74-88ce-22674f7624b1
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "90"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "53":
    id: "53"
    taskid: 62266d71-a27d-4c4e-8193-e3cfd985e1bb
    type: regular
    task:
      id: 62266d71-a27d-4c4e-8193-e3cfd985e1bb
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 8855
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "54":
    id: "54"
    taskid: 64bd8b29-c6f9-419e-84b0-c3929f237a19
    type: regular
    task:
      id: 64bd8b29-c6f9-419e-84b0-c3929f237a19
      version: -1
      name: Send Domain Query
      description: Sends http request. Returns the response as json.
      scriptName: http
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      headers:
        simple: Accept:application/taxii+json
      method:
        simple: GET
      url:
        complex:
          root: ServerURL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: threatintel/collections/
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: TAXIIServer.Collection.id
                iscontext: true
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /objects/?limit=90000&match[type]=domain-name
      password:
        simple: '{TOMMED}hN8Z2Wla7d/ubqIFl5FVSmCbTHPjHAHo8iVEZ59AB9vpZ72BLofUaRkGG/JPNKMCTCcN9iWnVIPTmZnZSjak7w=='
      username:
        simple: ${inputs.username}
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9030
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "55":
    id: "55"
    taskid: 0d4faba9-8600-4a21-817d-89d738c44708
    type: condition
    task:
      id: 0d4faba9-8600-4a21-817d-89d738c44708
      version: -1
      name: Assert Search Time OK
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "59"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: lessThanOrEqual
          left:
            value:
              complex:
                root: HttpRequest.Response.Headers
                accessor: X-Taxii2server-Query-Time-Secs
                transformers:
                - operator: round
            iscontext: true
          right:
            value:
              simple: "90"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9205
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "56":
    id: "56"
    taskid: e126d2f0-84a1-4432-86a0-51684a9007a9
    type: title
    task:
      id: e126d2f0-84a1-4432-86a0-51684a9007a9
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 10080
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "57":
    id: "57"
    taskid: f637c17a-581b-41ef-80f4-81efe6f7cedb
    type: regular
    task:
      id: f637c17a-581b-41ef-80f4-81efe6f7cedb
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 4890
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "58":
    id: "58"
    taskid: 14fe4b23-c2aa-4c51-85f9-f03978aa02d9
    type: regular
    task:
      id: 14fe4b23-c2aa-4c51-85f9-f03978aa02d9
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 7135
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "59":
    id: "59"
    taskid: 227c57a8-3164-4479-81ed-9bf6b9c03d10
    type: regular
    task:
      id: 227c57a8-3164-4479-81ed-9bf6b9c03d10
      version: -1
      name: Clear Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: ${HttpRequest}
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9380
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "60":
    id: "60"
    taskid: 70f23180-2183-442c-8e3d-3136a46fbe7d
    type: regular
    task:
      id: 70f23180-2183-442c-8e3d-3136a46fbe7d
      version: -1
      name: Clear HeyConcurrency Context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    scriptarguments:
      all:
        simple: "no"
      key:
        simple: HeyConcurrency
    separatecontext: false
    continueonerror: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 9905
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "61":
    id: "61"
    taskid: 56c4d34a-a8f8-467b-80ff-99f87b904697
    type: regular
    task:
      id: 56c4d34a-a8f8-467b-80ff-99f87b904697
      version: -1
      name: taxii-server-list-collections
      description: Returns all the collections.
      script: TAXII2 Server|||taxii-server-list-collections
      type: regular
      iscommand: true
      brand: TAXII2 Server
    nexttasks:
      '#none#':
      - "29"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 3315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: f156d5c3-9cfb-4699-8371-7a97b07b3382
    type: regular
    task:
      id: f156d5c3-9cfb-4699-8371-7a97b07b3382
      version: -1
      name: Get server info
      description: Get version and URL of current XSOAR server.
      scriptName: GetServerInfo
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "63"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2645
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "63":
    id: "63"
    taskid: b3a43523-7d49-47ea-8bff-ea8b00dc3e19
    type: condition
    task:
      id: b3a43523-7d49-47ea-8bff-ea8b00dc3e19
      version: -1
      name: Is XSOAR 6
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "64"
      "yes":
      - "27"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: startWith
          left:
            value:
              simple: ServerInfo.version.version
            iscontext: true
          right:
            value:
              simple: "6"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2820
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "64":
    id: "64"
    taskid: 31720589-f13c-43ca-8684-4489f4b5fc3f
    type: regular
    task:
      id: 31720589-f13c-43ca-8684-4489f4b5fc3f
      version: -1
      name: Set URL For XSOAR 8
      description: Set a value in context under the key you entered.
      scriptName: Set
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      key:
        simple: ServerURL
      value:
        complex:
          root: ServerURL
          accessor: URL
          transformers:
          - operator: concat
            args:
              prefix: {}
              suffix:
                value:
                  simple: /xsoar/instance/execute/taxii2server/
          - operator: replace
            args:
              limit: {}
              replaceWith:
                value:
                  simple: https://ext-
              toReplace:
                value:
                  simple: https://
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2995
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 10095,
        "width": 820,
        "x": 40,
        "y": 50
      }
    }
  }
inputs:
- key: edl_name
  value:
    simple: edl
  required: false
  description: EDL instance URL.
  playbookInputQuery:
- key: z
  value: {}
  required: false
  description: Duration of application to send requests.
  playbookInputQuery:
- key: "n"
  value: {}
  required: false
  description: The number of requests to run. Default is 200.
  playbookInputQuery:
- key: iocs_in_xsoar
  value:
    simple: "90000"
  required: false
  description: Expected number of indicators in the system.
  playbookInputQuery:
- key: username
  value:
    simple: test12
  required: false
  description: The username for the TAXII server.
  playbookInputQuery:
outputs: []
fromversion: 6.1.0
description: ''