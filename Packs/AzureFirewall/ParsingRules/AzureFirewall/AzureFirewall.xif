[INGEST:vendor="msft", product="azure", target_dataset="msft_azure_firewall_raw", no_hit = keep]
filter // assert log record is an Azure Firewall log with a RFC 3339 compatible timestamp; e.g., 2024-11-13T17:07:26.458400+03:00. 
    category in ("AZFWApplicationRule", "AZFWApplicationRuleAggregation", "AZFWDnsQuery", "AZFWFatFlow", "AZFWIdpsSignature", "AZFWNatRule", "AZFWNatRuleAggregation", "AZFWNetworkRule", "AZFWNetworkRuleAggregation", "AZFWThreatIntel")
    and time ~= "\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?[+-]\d{2}:\d{2}"
| alter _time = parse_timestamp("%FT%H:%M:%E*S%Ez", to_string(time)); 